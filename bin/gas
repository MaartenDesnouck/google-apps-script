#!/usr/bin/env node

var package = require('../package.json');
var program = require('commander');
var path = require('path');
var lib = path.join(__dirname, '../lib');

program
    .version(package.version);

program
    .command('auth')
    .option('-f, --force', 'Force reauthentication')
    .description('authenticate the Drive API (add \'-f\' to force reauthentication)')
    .action(require(lib + '/auth'));

program
    .command('remote', '\'remote create <name>\' to create a new project in your Google Drive' +
        '\n\t\t       ' + '\'remote delete <fileId>\' to delete a project from your Google Drive' +
        '\n\t\t       ' + '\'remote link <fileId>\' to link a remote Google Drive project to your current folder')

program
    .command('list [nameFilter]')
    .description('list your script files and their fileId\'s (optional filter on filename)')
    .action(require(lib + '/list'));

program
    .command('clone <fileId>')
    .description('create a new local folder, link the remote project with the given fileId and do a pull from remote')
    .action(require(lib + '/clone'));

program
    .command('new <name>')
    .description('create a new Google Apps Script project in your Google Drive and then clone that project locally')
    .action(require(lib + '/new'));

program
    .command('push')
    .alias('deploy')
    .description('push your local code to the linked project on your Google Drive')
    .action(require(lib + '/push'));

program
    .command('pull')
    .description('when a project is already cloned, pull new code from your Google Drive')
    .action(require(lib + '/pull'));

program.on('--help', function() {
    console.log('  Examples:');
    console.log('');
    console.log('    $ gas new script');
    console.log('    $ cd script');
    console.log('    $ gas pull');
    console.log('');
    console.log('    $ gas list my-awesome-script');
    console.log('    $ gas clone 19PJVrJufmoSaOYdRvp-bARPw7Rg83zZqlFwhpSeUkV8ahnLo3MDuJG9E');
    console.log('');
    console.log('    $ mkdir src');
    console.log('    $ cd src');
    console.log('    $ gas remote link 19PJVrJufmoSaOYdRvp-bARPw7Rg83zZqlFwhpSeUkV8ahnLo3MDuJG9E');
    console.log('    $ gas pull scr');
    console.log('');
});

program.parse(process.argv);
