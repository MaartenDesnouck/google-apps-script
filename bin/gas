#!/usr/bin/env node

var package = require('../package.json');
var path = require('path');
var program = require('commander');

var lib = path.join(__dirname, '../lib');

program
    .version(package.version);

program
    .command('auth')
    .option('-f, --force', 'Force reauthentication')
    .description('authenticate Drive API (add \'-f\' to force reauthentication)')
    .action(require(lib + '/auth'));

  program
      .command('remote create <name>')
      .description('create a new remote project')
      .action(require(lib + '/pull'));

  program
      .command('remote add <fileId>')
      .description('add or replace the remote project linked to the current folder')
      .action(require(lib + '/pull'));

program
    .command('list [nameFilter]')
    .description('list your script files and their id\'s (optional filter on filename)')
    .action(require(lib + '/list'));

program
    .command('clone <fileId>')
    .description('clone a script file with a given fileId (see \'list\')')
    .action(require(lib + '/clone'));

program
    .command('new <name>')
    .description('create a new Google Apps Script project (locally and in your Google Drive)')
    .action(require(lib + '/new'));

program
    .command('push')
    .alias('deploy')
    .description('push your local code to the linked project on your Google Drive')
    .action(require(lib + '/push'));

program
    .command('pull')
    .description('when a project is already cloned, pull new code from your Google Drive')
    .action(require(lib + '/pull'));

program
    .command('*')
    .action(function(env) {
        console.log('\'gas %s\' is not a valid command use \'gas -h\' for help', env);
        process.exit(2);
    });

program.on('--help', function() {
    console.log('  Examples:');
    console.log('');
    console.log('    $ gas new script');
    console.log('    $ cd script');
    console.log('    $ gas pull');
    console.log('');
    console.log('    $ gas list my-awesome-script');
    console.log('    $ gas clone 19PJVrJufmoSaOYdRvp-bARPw7Rg83zZqlFwhpSeUkV8ahnLo3MDuJG9E');
    console.log('');
});

program
    .parse(process.argv);

if (program.args.length < 1) {
    program.outputHelp();
    process.exit(2);
}
